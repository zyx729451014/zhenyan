!function(s){var t={tyTips:function(s){TY.loader("Qing.ui.tips",function(){new TY.ui.tips({position:"midCenter",el:s.$el||null,type:s.type||"success",msg:s.msg||"成功",time:s.time||2e3,callback:function(){s.cb&&"function"==typeof s.cb&&s.cb()}})})},showTipsMsg:function(s,t,i){var e="";switch(t){case"info":e="form-tips tips-info";break;case"error":e="form-tips tips-error";break;case"success":e="form-tips tips-success"}s.attr("class",e).html(i)},checkPwd:function(){function t(s){var t=s.charAt(0),i=new RegExp("^["+t+"]+$","gi");if(i.test(s))return"密码不能为重复的字符";for(var e=s.charCodeAt(0),r=s.length-1;r>=0&&s.charCodeAt(r)==e+r--;);if(-1==r)return"密码不能为连续的字符";var n=["1234qwer","5201314"];for(var c in n)if(n[c]==s)return"该密码过于简单";return""==s.replace(/\d+/,"")?"密码不能为纯数字":""==s.replace(/[a-z]+/,"")?"密码不能为纯小写字母":""}var i=s("#oldpassword").val(),e=s("#password").val(),r=s("#password_tips"),n="";return 0==e.length?(this.showTipsMsg(r,"error","请输入密码"),!1):e.length<6?(this.showTipsMsg(r,"error","密码不能小于6位"),!1):""!=(n=t(e))?(this.showTipsMsg(r,"error",n),!1):e==i?(this.showTipsMsg(r,"error","新密码不能与旧密码相同"),!1):(this.showTipsMsg(r,"success",""),!0)},checkPwd2:function(){var t=s("#password").val(),i=s("#password2").val(),e=s("#password2_tips");return this.checkPwd()?0==i.length?(this.showTipsMsg(e,"error","请再次输入密码"),!1):t!==i?(this.showTipsMsg(e,"error","两次输入密码不一致"),!1):(this.showTipsMsg(e,"success",""),!0):(this.showTipsMsg(e,"error","请先设置正确的密码"),!1)},checkVcode:function(){var t=s("#vc").val(),i=s("#vc_tips");return""==t?(this.showTipsMsg(i,"error","请输入验证码"),!1):(this.showTipsMsg(i,"success",""),!0)},checkPswStrength:function(){var t=s("#password").val(),i=0;/\d/.test(t)&&i++,/[a-z]/.test(t)&&i++,/[A-Z]/.test(t)&&i++,/\W/.test(t)&&i++,i>3?i=3:void 0,s(".lv-state-bg .rate").css("width",Math.round(33.33*i)+"%")},bindEvents:function(){var t=this;s("#password").bind("blur",function(){t.checkPwd(),s("#password2").val()&&t.checkPwd2()}).bind("keyup change",function(){t.checkPswStrength()}),s("#password2").bind("blur",function(){t.checkPwd2()}),s("#vc").bind("blur",function(){t.checkVcode()}),s(".change-vcode-img").bind("click",function(){s(".vcode-img").attr("src","//imgcode.tianya.cn/services/ImageCodeService?_r="+(new Date).getTime()),s("#vc").val("")}),s(".form-action .btn").bind("click",function(){t.checkPwd()&&t.checkPwd2()&&t.checkVcode()&&s("#updatepsFrm").submit()})},init:function(){this.bindEvents(),s("#updatepsFrm input").each(function(){s(this).val()&&s(this).trigger("blur")}),window.tipsJson&&"object"==typeof tipsJson&&this.tyTips({type:tipsJson.type,msg:tipsJson.msg,time:3e3,cb:function(){"success"==tipsJson.type&&TY.loginAction({initType:"normal",forwardURL:s("input[name='fowardURL']").val()}),"success"==tipsJson.type&&""==s("input[name='fowardURL']").val()&&TY.loginAction({initType:"normal",forwardURL:tipsJson.url})}})}};s(function(){t.init()})}(jQuery);